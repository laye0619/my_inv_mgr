from abc import abstractmethod, ABCMeta

import utility as ut
import tushare as ts
import xalpha as xa
import matplotlib
import pandas as pd

# print(ut.DATA_ROOT)
# print(ut.REPORT_ROOT)
# print(ut.PARAMS_ROOT)
#
# pro = ts.pro_api('602e5ad960d66ab8b1f3c13b4fd746f5323ff808b0820768b02c6da3')


data = [
    {
        "date": "2020-03-03T00:00:00+08:00",
        "pb": {
            "avg": 2.5910808045599496,
            "median": 1.9003468179511729,
            "ewpvo": 1.6597197972119744,
            "ew": 1.6597197972119744,
            "mcw": 1.9703366066831245,
            "fs": {
                "avg": {
                    "avgv": 3.494598106245687,
                    "cv": 2.5910808045599496,
                    "cvpos": 0.20137801440651426,
                    "maxpv": 7.490529503848777,
                    "maxv": 7.490529503848777,
                    "minv": 1.4905490238574692,
                    "q2v": 2.58761152887473,
                    "q5v": 3.364577996555984,
                    "q8v": 4.429393850468881
                },
                "ew": {
                    "avgv": 2.7138096645447107,
                    "cv": 1.6597197972119744,
                    "cvpos": 0.0833072345756342,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.2806082377837151,
                    "q2v": 1.9823989227656547,
                    "q5v": 2.5987888796863174,
                    "q8v": 3.4897343220173287
                },
                "ewpvo": {
                    "avgv": 2.7135559469030546,
                    "cv": 1.6597197972119744,
                    "cvpos": 0.0833072345756342,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.2806082377837151,
                    "q2v": 1.9823989227656547,
                    "q5v": 2.5987888796863174,
                    "q8v": 3.4877021139006845
                },
                "mcw": {
                    "avgv": 2.9348448213280616,
                    "cv": 1.9703366066831245,
                    "cvpos": 0.13216410898841216,
                    "maxpv": 5.864903495168779,
                    "maxv": 5.864903495168779,
                    "minv": 1.4366804434954874,
                    "q2v": 2.1808419639550354,
                    "q5v": 2.7658572727513224,
                    "q8v": 3.7614016045429386
                },
                "median": {
                    "avgv": 3.036564421606639,
                    "cv": 1.9003468179511729,
                    "cvpos": 0.12151581584716567,
                    "maxpv": 6.209810482835302,
                    "maxv": 6.209810482835302,
                    "minv": 1.3330803263025213,
                    "q2v": 2.229869943233515,
                    "q5v": 2.930336139751996,
                    "q8v": 3.908238225461515
                }
            },
            "y10": {
                "avg": {
                    "avgv": 3.328691862568918,
                    "cv": 2.5910808045599496,
                    "cvpos": 0.21596051007815714,
                    "maxpv": 7.490529503848777,
                    "maxv": 7.490529503848777,
                    "minv": 1.8020709234193797,
                    "q2v": 2.5572421453128475,
                    "q5v": 3.197023881448386,
                    "q8v": 4.043427876664286
                },
                "ew": {
                    "avgv": 2.5172901790309457,
                    "cv": 1.6597197972119744,
                    "cvpos": 0.0941999177293295,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.956808125112463,
                    "q5v": 2.426183014310071,
                    "q8v": 3.133215970962295
                },
                "ewpvo": {
                    "avgv": 2.517245686066805,
                    "cv": 1.6597197972119744,
                    "cvpos": 0.0941999177293295,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.956808125112463,
                    "q5v": 2.426183014310071,
                    "q8v": 3.133215970962295
                },
                "mcw": {
                    "avgv": 2.7021163540728836,
                    "cv": 1.9703366066831245,
                    "cvpos": 0.14726450020567666,
                    "maxpv": 5.864903495168779,
                    "maxv": 5.864903495168779,
                    "minv": 1.5344074972018051,
                    "q2v": 2.134776722609013,
                    "q5v": 2.577601283185202,
                    "q8v": 3.369672974412804
                },
                "median": {
                    "avgv": 2.860150597548531,
                    "cv": 1.9003468179511729,
                    "cvpos": 0.1353352529823118,
                    "maxpv": 6.209810482835302,
                    "maxv": 6.209810482835302,
                    "minv": 1.4460338306793852,
                    "q2v": 2.182733674318496,
                    "q5v": 2.7750858116542707,
                    "q8v": 3.5391982136532034
                }
            },
            "y5": {
                "avg": {
                    "avgv": 3.292078173209747,
                    "cv": 2.5910808045599496,
                    "cvpos": 0.32786885245901637,
                    "maxpv": 7.490529503848777,
                    "maxv": 7.490529503848777,
                    "minv": 1.8020709234193797,
                    "q2v": 2.2765066771084337,
                    "q5v": 3.325456611051519,
                    "q8v": 3.8566504911724078
                },
                "ew": {
                    "avgv": 2.449872215333947,
                    "cv": 1.6597197972119744,
                    "cvpos": 0.18770491803278688,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.6671803647776413,
                    "q5v": 2.532753383242549,
                    "q8v": 2.8485896821098105
                },
                "ewpvo": {
                    "avgv": 2.4497835938034065,
                    "cv": 1.6597197972119744,
                    "cvpos": 0.18770491803278688,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.6671803647776413,
                    "q5v": 2.532753383242549,
                    "q8v": 2.8485896821098105
                },
                "mcw": {
                    "avgv": 2.6478654783233204,
                    "cv": 1.9703366066831245,
                    "cvpos": 0.2819672131147541,
                    "maxpv": 5.864903495168779,
                    "maxv": 5.864903495168779,
                    "minv": 1.5344074972018051,
                    "q2v": 1.846325935230252,
                    "q5v": 2.690354446068316,
                    "q8v": 3.0250159986566785
                },
                "median": {
                    "avgv": 2.7648871743612085,
                    "cv": 1.9003468179511729,
                    "cvpos": 0.26557377049180325,
                    "maxpv": 6.209810482835302,
                    "maxv": 6.209810482835302,
                    "minv": 1.4460338306793852,
                    "q2v": 1.7963046283693966,
                    "q5v": 2.8458263708603306,
                    "q8v": 3.370156948278269
                }
            }
        },
        "pe_ttm": {
            "avg": 33.1581282241868,
            "median": 29.663012853026665,
            "ewpvo": 19.335282011077766,
            "ew": 26.72673860358103,
            "mcw": 26.753754357349724,
            "fs": {
                "avg": {
                    "avgv": 46.852993649869916,
                    "cv": 33.1581282241868,
                    "cvpos": 0.24177889132477295,
                    "maxpv": 107.94236944994489,
                    "maxv": 107.94236944994489,
                    "minv": 20.57058988165633,
                    "q2v": 31.436337321156543,
                    "q5v": 43.85844850097054,
                    "q8v": 59.667430751296024
                },
                "ew": {
                    "avgv": 44.305672727484506,
                    "cv": 26.72673860358103,
                    "cvpos": 0.12840588787973692,
                    "maxpv": 144.15314699776803,
                    "maxv": 144.15314699776803,
                    "minv": 17.071668314159723,
                    "q2v": 28.883724898483294,
                    "q5v": 37.031766688645064,
                    "q8v": 56.99111467683345
                },
                "ewpvo": {
                    "avgv": 32.794710154916906,
                    "cv": 19.335282011077766,
                    "cvpos": 0.10773567178202317,
                    "maxpv": 73.22225562507863,
                    "maxv": 73.22225562507863,
                    "minv": 14.938581751775315,
                    "q2v": 22.838828849036265,
                    "q5v": 31.543313497920252,
                    "q8v": 41.40013100612317
                },
                "mcw": {
                    "avgv": 40.5257172565278,
                    "cv": 26.753754357349724,
                    "cvpos": 0.21829000939555276,
                    "maxpv": 93.01328551850189,
                    "maxv": 93.01328551850189,
                    "minv": 16.025240541582416,
                    "q2v": 26.35682875910018,
                    "q5v": 34.04722647146686,
                    "q8v": 53.01735635091512
                },
                "median": {
                    "avgv": 41.937697590511156,
                    "cv": 29.663012853026665,
                    "cvpos": 0.2198559348575008,
                    "maxpv": 87.91689774666767,
                    "maxv": 87.91689774666767,
                    "minv": 19.0513075166794,
                    "q2v": 29.328814354637228,
                    "q5v": 38.58322988207962,
                    "q8v": 54.53404229978108
                }
            },
            "y10": {
                "avg": {
                    "avgv": 42.72640027796494,
                    "cv": 33.1581282241868,
                    "cvpos": 0.27313862607980255,
                    "maxpv": 106.28465601400269,
                    "maxv": 106.28465601400269,
                    "minv": 22.369512760300818,
                    "q2v": 30.605672978389304,
                    "q5v": 39.71797334304631,
                    "q8v": 53.16767846577813
                },
                "ew": {
                    "avgv": 36.87648983576569,
                    "cv": 26.72673860358103,
                    "cvpos": 0.13574660633484162,
                    "maxpv": 144.15314699776803,
                    "maxv": 144.15314699776803,
                    "minv": 17.071668314159723,
                    "q2v": 28.653755796751533,
                    "q5v": 34.424073960660266,
                    "q8v": 48.40116965070023
                },
                "ewpvo": {
                    "avgv": 29.499707483925878,
                    "cv": 19.335282011077766,
                    "cvpos": 0.1258741258741259,
                    "maxpv": 65.5514437308845,
                    "maxv": 65.5514437308845,
                    "minv": 15.245887550235754,
                    "q2v": 22.3672017430325,
                    "q5v": 27.43949975501681,
                    "q8v": 37.33347788875745
                },
                "mcw": {
                    "avgv": 34.85067070558474,
                    "cv": 26.753754357349724,
                    "cvpos": 0.24146441793500617,
                    "maxpv": 86.72417835321097,
                    "maxv": 86.72417835321097,
                    "minv": 16.025240541582416,
                    "q2v": 26.10662707734765,
                    "q5v": 30.984918325722234,
                    "q8v": 44.46438139780468
                },
                "median": {
                    "avgv": 37.94129362218685,
                    "cv": 29.663012853026665,
                    "cvpos": 0.2439325380501851,
                    "maxpv": 87.91689774666767,
                    "maxv": 87.91689774666767,
                    "minv": 19.33217113772163,
                    "q2v": 28.87749146352703,
                    "q5v": 34.253204273915856,
                    "q8v": 48.63731646958008
                }
            },
            "y5": {
                "avg": {
                    "avgv": 44.62920203638266,
                    "cv": 33.1581282241868,
                    "cvpos": 0.3483606557377049,
                    "maxpv": 106.28465601400269,
                    "maxv": 106.28465601400269,
                    "minv": 22.369512760300818,
                    "q2v": 28.439497217537266,
                    "q5v": 43.838804879149954,
                    "q8v": 57.31433590280091
                },
                "ew": {
                    "avgv": 39.37710991802507,
                    "cv": 26.72673860358103,
                    "cvpos": 0.22213114754098362,
                    "maxpv": 144.15314699776803,
                    "maxv": 144.15314699776803,
                    "minv": 17.071668314159723,
                    "q2v": 26.22396516403932,
                    "q5v": 36.51900088894174,
                    "q8v": 52.48715553377957
                },
                "ewpvo": {
                    "avgv": 30.09332793428502,
                    "cv": 19.335282011077766,
                    "cvpos": 0.25081967213114753,
                    "maxpv": 65.5514437308845,
                    "maxv": 65.5514437308845,
                    "minv": 15.245887550235754,
                    "q2v": 18.530289673568976,
                    "q5v": 32.319560106688186,
                    "q8v": 37.976890846145466
                },
                "mcw": {
                    "avgv": 35.778496374224204,
                    "cv": 26.753754357349724,
                    "cvpos": 0.3737704918032787,
                    "maxpv": 81.43928125748197,
                    "maxv": 81.43928125748197,
                    "minv": 16.025240541582416,
                    "q2v": 23.304538853801603,
                    "q5v": 33.83473087988403,
                    "q8v": 47.81667817662355
                },
                "median": {
                    "avgv": 38.84357324448938,
                    "cv": 29.663012853026665,
                    "cvpos": 0.34672131147540985,
                    "maxpv": 87.91689774666767,
                    "maxv": 87.91689774666767,
                    "minv": 19.33217113772163,
                    "q2v": 26.074425364929994,
                    "q5v": 38.50945834856204,
                    "q8v": 50.074453183509505
                }
            }
        },
        "cp": 5710.02,
        "stockCode": "000905"
    },
    {
        "date": "2020-03-02T00:00:00+08:00",
        "pb": {
            "avg": 2.534781260737011,
            "median": 1.88116476841215,
            "ewpvo": 1.6447326236409918,
            "ew": 1.6447326236409918,
            "mcw": 1.9528607904172757,
            "fs": {
                "avg": {
                    "avgv": 3.494881074395291,
                    "cv": 2.534781260737011,
                    "cvpos": 0.17919799498746866,
                    "maxpv": 7.490529503848777,
                    "maxv": 7.490529503848777,
                    "minv": 1.4905490238574692,
                    "q2v": 2.5872616547560088,
                    "q5v": 3.3647872923414157,
                    "q8v": 4.429602137923549
                },
                "ew": {
                    "avgv": 2.7141397897771977,
                    "cv": 1.6447326236409918,
                    "cvpos": 0.07393483709273183,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.2806082377837151,
                    "q2v": 1.9823989227656547,
                    "q5v": 2.5988041294387316,
                    "q8v": 3.4897367312117726
                },
                "ewpvo": {
                    "avgv": 2.713885992674959,
                    "cv": 1.6447326236409918,
                    "cvpos": 0.07456140350877193,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.2806082377837151,
                    "q2v": 1.9823989227656547,
                    "q5v": 2.5988041294387316,
                    "q8v": 3.4880971647150236
                },
                "mcw": {
                    "avgv": 2.935146890922375,
                    "cv": 1.9528607904172757,
                    "cvpos": 0.12719298245614036,
                    "maxpv": 5.864903495168779,
                    "maxv": 5.864903495168779,
                    "minv": 1.4366804434954874,
                    "q2v": 2.1808419639550354,
                    "q5v": 2.7659143896004172,
                    "q8v": 3.762490726111063
                },
                "median": {
                    "avgv": 3.036920268021815,
                    "cv": 1.88116476841215,
                    "cvpos": 0.11842105263157894,
                    "maxpv": 6.209810482835302,
                    "maxv": 6.209810482835302,
                    "minv": 1.3330803263025213,
                    "q2v": 2.229869943233515,
                    "q5v": 2.9306239277463435,
                    "q8v": 3.9089895678255058
                }
            },
            "y10": {
                "avg": {
                    "avgv": 3.3296086018510977,
                    "cv": 2.534781260737011,
                    "cvpos": 0.19004524886877827,
                    "maxpv": 7.490529503848777,
                    "maxv": 7.490529503848777,
                    "minv": 1.8020709234193797,
                    "q2v": 2.5572421453128475,
                    "q5v": 3.200946321209025,
                    "q8v": 4.047774106942024
                },
                "ew": {
                    "avgv": 2.5182638775762665,
                    "cv": 1.6447326236409918,
                    "cvpos": 0.08309337721102426,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.9570762156696506,
                    "q5v": 2.427163110819195,
                    "q8v": 3.1364976086583543
                },
                "ewpvo": {
                    "avgv": 2.5182193846121264,
                    "cv": 1.6447326236409918,
                    "cvpos": 0.08391608391608392,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.9570762156696506,
                    "q5v": 2.427163110819195,
                    "q8v": 3.1364976086583543
                },
                "mcw": {
                    "avgv": 2.703024666199705,
                    "cv": 1.9528607904172757,
                    "cvpos": 0.14356232003290828,
                    "maxpv": 5.864903495168779,
                    "maxv": 5.864903495168779,
                    "minv": 1.5344074972018051,
                    "q2v": 2.1350004181664803,
                    "q5v": 2.578925169565089,
                    "q8v": 3.374284568121733
                },
                "median": {
                    "avgv": 2.8611457005464525,
                    "cv": 1.88116476841215,
                    "cvpos": 0.13368983957219252,
                    "maxpv": 6.209810482835302,
                    "maxv": 6.209810482835302,
                    "minv": 1.4460338306793852,
                    "q2v": 2.184192002968166,
                    "q5v": 2.776060277688825,
                    "q8v": 3.5396010922004635
                }
            },
            "y5": {
                "avg": {
                    "avgv": 3.2932268066469583,
                    "cv": 2.534781260737011,
                    "cvpos": 0.3114754098360656,
                    "maxpv": 7.490529503848777,
                    "maxv": 7.490529503848777,
                    "minv": 1.8020709234193797,
                    "q2v": 2.2765066771084337,
                    "q5v": 3.3298316368689505,
                    "q8v": 3.857400839833461
                },
                "ew": {
                    "avgv": 2.451025606329816,
                    "cv": 1.6447326236409918,
                    "cvpos": 0.16557377049180327,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.667324991232558,
                    "q5v": 2.5332328635685712,
                    "q8v": 2.8487709821580953
                },
                "ewpvo": {
                    "avgv": 2.4509369847992755,
                    "cv": 1.6447326236409918,
                    "cvpos": 0.16721311475409836,
                    "maxpv": 5.4856633546702644,
                    "maxv": 5.4856633546702644,
                    "minv": 1.373774957631363,
                    "q2v": 1.667324991232558,
                    "q5v": 2.5332328635685712,
                    "q8v": 2.8487709821580953
                },
                "mcw": {
                    "avgv": 2.6489344818803557,
                    "cv": 1.9528607904172757,
                    "cvpos": 0.2778688524590164,
                    "maxpv": 5.864903495168779,
                    "maxv": 5.864903495168779,
                    "minv": 1.5344074972018051,
                    "q2v": 1.846325935230252,
                    "q5v": 2.6927052932798032,
                    "q8v": 3.0275740076647835
                },
                "median": {
                    "avgv": 2.7661744124652454,
                    "cv": 1.88116476841215,
                    "cvpos": 0.26229508196721313,
                    "maxpv": 6.209810482835302,
                    "maxv": 6.209810482835302,
                    "minv": 1.4460338306793852,
                    "q2v": 1.7963046283693966,
                    "q5v": 2.8502692571224317,
                    "q8v": 3.3733353214698387
                }
            }
        },
        "pe_ttm": {
            "avg": 32.738210179906375,
            "median": 29.269691414648925,
            "ewpvo": 19.207361179476546,
            "ew": 26.536370286223352,
            "mcw": 26.516463077278672,
            "fs": {
                "avg": {
                    "avgv": 46.85728267756352,
                    "cv": 32.738210179906375,
                    "cvpos": 0.23339598997493735,
                    "maxpv": 107.94236944994489,
                    "maxv": 107.94236944994489,
                    "minv": 20.57058988165633,
                    "q2v": 31.407068970440307,
                    "q5v": 43.87809212279113,
                    "q8v": 59.685849367561445
                },
                "ew": {
                    "avgv": 44.31117818759221,
                    "cv": 26.536370286223352,
                    "cvpos": 0.12343358395989974,
                    "maxpv": 144.15314699776803,
                    "maxv": 144.15314699776803,
                    "minv": 17.071668314159723,
                    "q2v": 28.883724898483294,
                    "q5v": 37.03510137717737,
                    "q8v": 57.03485757676775
                },
                "ewpvo": {
                    "avgv": 32.79892544716365,
                    "cv": 19.207361179476546,
                    "cvpos": 0.10369674185463659,
                    "maxpv": 73.22225562507863,
                    "maxv": 73.22225562507863,
                    "minv": 14.938581751775315,
                    "q2v": 22.838828849036265,
                    "q5v": 31.589137824532617,
                    "q8v": 41.41597969655161
                },
                "mcw": {
                    "avgv": 40.53003043000077,
                    "cv": 26.516463077278672,
                    "cvpos": 0.20614035087719298,
                    "maxpv": 93.01328551850189,
                    "maxv": 93.01328551850189,
                    "minv": 16.025240541582416,
                    "q2v": 26.35581291969061,
                    "q5v": 34.05173756221465,
                    "q8v": 53.155504445804155
                },
                "median": {
                    "avgv": 41.941541838784715,
                    "cv": 29.269691414648925,
                    "cvpos": 0.19705513784461154,
                    "maxpv": 87.91689774666767,
                    "maxv": 87.91689774666767,
                    "minv": 19.0513075166794,
                    "q2v": 29.328652410073076,
                    "q5v": 38.587135105802076,
                    "q8v": 54.80842366985158
                }
            },
            "y10": {
                "avg": {
                    "avgv": 42.7396704605423,
                    "cv": 32.738210179906375,
                    "cvpos": 0.2620320855614973,
                    "maxpv": 106.28465601400269,
                    "maxv": 106.28465601400269,
                    "minv": 22.369512760300818,
                    "q2v": 30.605672978389304,
                    "q5v": 39.72424357608064,
                    "q8v": 53.17825815671057
                },
                "ew": {
                    "avgv": 36.86550022285303,
                    "cv": 26.536370286223352,
                    "cvpos": 0.13039901275195392,
                    "maxpv": 144.15314699776803,
                    "maxv": 144.15314699776803,
                    "minv": 17.071668314159723,
                    "q2v": 28.66204645459603,
                    "q5v": 34.431297983508856,
                    "q8v": 48.518784259145
                },
                "ewpvo": {
                    "avgv": 29.512698962549788,
                    "cv": 19.207361179476546,
                    "cvpos": 0.12134923899629782,
                    "maxpv": 65.5514437308845,
                    "maxv": 65.5514437308845,
                    "minv": 15.245887550235754,
                    "q2v": 22.37066335752843,
                    "q5v": 27.443607856754717,
                    "q8v": 37.334002993584946
                },
                "mcw": {
                    "avgv": 34.87509654929298,
                    "cv": 26.516463077278672,
                    "cvpos": 0.2258329905388729,
                    "maxpv": 86.72417835321097,
                    "maxv": 86.72417835321097,
                    "minv": 16.025240541582416,
                    "q2v": 26.10662707734765,
                    "q5v": 30.993997473026518,
                    "q8v": 44.46545023320487
                },
                "median": {
                    "avgv": 37.95607398656812,
                    "cv": 29.269691414648925,
                    "cvpos": 0.2155491567256273,
                    "maxpv": 87.91689774666767,
                    "maxv": 87.91689774666767,
                    "minv": 19.33217113772163,
                    "q2v": 28.87749146352703,
                    "q5v": 34.26463077491576,
                    "q8v": 48.64447172780299
                }
            },
            "y5": {
                "avg": {
                    "avgv": 44.647944082467426,
                    "cv": 32.738210179906375,
                    "cvpos": 0.34262295081967215,
                    "maxpv": 106.28465601400269,
                    "maxv": 106.28465601400269,
                    "minv": 22.369512760300818,
                    "q2v": 28.439497217537266,
                    "q5v": 43.88991177949098,
                    "q8v": 57.31433590280091
                },
                "ew": {
                    "avgv": 39.38903590314351,
                    "cv": 26.536370286223352,
                    "cvpos": 0.21639344262295082,
                    "maxpv": 144.15314699776803,
                    "maxv": 144.15314699776803,
                    "minv": 17.071668314159723,
                    "q2v": 26.22396516403932,
                    "q5v": 36.52349041783136,
                    "q8v": 52.48715553377957
                },
                "ewpvo": {
                    "avgv": 30.10663906048457,
                    "cv": 19.207361179476546,
                    "cvpos": 0.24180327868852458,
                    "maxpv": 65.5514437308845,
                    "maxv": 65.5514437308845,
                    "minv": 15.245887550235754,
                    "q2v": 18.530289673568976,
                    "q5v": 32.33153661194918,
                    "q8v": 37.976890846145466
                },
                "mcw": {
                    "avgv": 35.79091018678577,
                    "cv": 26.516463077278672,
                    "cvpos": 0.3598360655737705,
                    "maxpv": 81.43928125748197,
                    "maxv": 81.43928125748197,
                    "minv": 16.025240541582416,
                    "q2v": 23.304538853801603,
                    "q5v": 33.83575095889297,
                    "q8v": 47.81667817662355
                },
                "median": {
                    "avgv": 38.85752007895219,
                    "cv": 29.269691414648925,
                    "cvpos": 0.33278688524590166,
                    "maxpv": 87.91689774666767,
                    "maxv": 87.91689774666767,
                    "minv": 19.33217113772163,
                    "q2v": 26.074425364929994,
                    "q5v": 38.511658568743414,
                    "q8v": 50.074453183509505
                }
            }
        },
        "cp": 5656.42,
        "stockCode": "000905"
    }
]
result_df = pd.DataFrame()
new_dict = {}
for date_item in data:
    for l1_k in date_item:
        if isinstance(date_item[l1_k], dict):
            for l2_k in date_item[l1_k]:
                if isinstance(date_item[l1_k][l2_k], dict):
                    for l3_k in date_item[l1_k][l2_k]:
                        if isinstance(date_item[l1_k][l2_k][l3_k], dict):
                            for l4_k in date_item[l1_k][l2_k][l3_k]:
                                new_dict['%s_%s_%s_%s' % (l1_k, l2_k, l3_k, l4_k)] = date_item[l1_k][l2_k][l3_k][l4_k]
                        else:
                            new_dict['%s_%s_%s' % (l1_k, l2_k, l3_k)] = date_item[l1_k][l2_k][l3_k]
                else:
                    new_dict['%s_%s' % (l1_k, l2_k)] = date_item[l1_k][l2_k]
        else:
            new_dict[l1_k] = date_item[l1_k]
    result_df = result_df.append(new_dict, ignore_index=True)
pass